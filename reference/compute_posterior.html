<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Compute posterior probabilities of P. vivax recurrence states — compute_posterior • Pv3Rs</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute posterior probabilities of P. vivax recurrence states — compute_posterior"><meta name="description" content="Computes per-person posterior probabilities of P. vivax recurrence states —
recrudescence, relapse, reinfection — using per-person genetic data on two
or more episodes. For usage, see Examples below and
demonstrate-usagevignette on Pv3Rs basic usage.
For a more complete understanding of compute_posterior output, see
https://aimeertaylor.github.io/Pv3Rs/articles/posterior-probabilitiesUnderstanding posterior probabilities.
Note: The progress bar may increment non-uniformly (see
Details); it may appear stuck when computations are ongoing."><meta property="og:description" content="Computes per-person posterior probabilities of P. vivax recurrence states —
recrudescence, relapse, reinfection — using per-person genetic data on two
or more episodes. For usage, see Examples below and
demonstrate-usagevignette on Pv3Rs basic usage.
For a more complete understanding of compute_posterior output, see
https://aimeertaylor.github.io/Pv3Rs/articles/posterior-probabilitiesUnderstanding posterior probabilities.
Note: The progress bar may increment non-uniformly (see
Details); it may appear stuck when computations are ongoing."><meta property="og:image" content="https://aimeertaylor.github.io/Pv3Rs/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Pv3Rs</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/aimeertaylor/Pv3Rs/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Compute posterior probabilities of <em>P. vivax</em> recurrence states</h1>
      <small class="dont-index">Source: <a href="https://github.com/aimeertaylor/Pv3Rs/blob/main/R/compute_posterior.R" class="external-link"><code>R/compute_posterior.R</code></a></small>
      <div class="d-none name"><code>compute_posterior.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Computes per-person posterior probabilities of <em>P. vivax</em> recurrence states —
recrudescence, relapse, reinfection — using per-person genetic data on two
or more episodes. For usage, see <strong>Examples</strong> below and
demonstrate-usagevignette on Pv3Rs basic usage.
For a more complete understanding of <code>compute_posterior</code> output, see
https://aimeertaylor.github.io/Pv3Rs/articles/posterior-probabilitiesUnderstanding posterior probabilities.</p>
<p>Note: The progress bar may increment non-uniformly (see
<strong>Details</strong>); it may appear stuck when computations are ongoing.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">compute_posterior</span><span class="op">(</span></span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">fs</span>,</span>
<span>  prior <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  MOIs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  return.RG <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  return.logp <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  progress.bar <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>List of lists encoding allelic data. The outer list contains
episodes in chronological order. The inner list contains named
markers per episode. Marker names must be consistent across episodes. <code>NA</code>
indicates missing marker data; otherwise, specify a per-marker
vector of distinct alleles detected (presently, <code>compute_posterior</code> does
not support data on the proportional abundance of detected alleles).
Repeat alleles and <code>NA</code> entries within allelic vectors are ignored.
Allele names are arbitrary, allowing for different data types, but must
correspond with frequency names.</p></dd>


<dt id="arg-fs">fs<a class="anchor" aria-label="anchor" href="#arg-fs"></a></dt>
<dd><p>List of per-marker allele frequency vectors, with names matching
marker names in <code>y</code>. Per-marker alleles frequencies mut contain one
frequency per named allele, with names matching alleles in <code>y</code>. Per-marker
frequencies must sum to one.</p></dd>


<dt id="arg-prior">prior<a class="anchor" aria-label="anchor" href="#arg-prior"></a></dt>
<dd><p>Matrix of prior probabilities of recurrence states per episode,
with rows as episodes in chronological order, and columns named "C", "L",
and "I" for recrudescence, relapse and reinfection, respectively. Row names
are ignored. If <code>NULL</code> (default), per-episode recurrence states are assumed
equally likely <em>a priori</em>.</p></dd>


<dt id="arg-mois">MOIs<a class="anchor" aria-label="anchor" href="#arg-mois"></a></dt>
<dd><p>Vector of per-episode multiplicities of infection (MOIs); because
the Pv3Rs model assumes no genotyping errors, <code>MOIs</code> must be greater than
or equal to the most parsimonious MOI estimates compatible with the data;
see <code>determine_MOIs(y)</code>. These are the estimates used when
<code>MOIs = NULL</code> (default).</p></dd>


<dt id="arg-return-rg">return.RG<a class="anchor" aria-label="anchor" href="#arg-return-rg"></a></dt>
<dd><p>Logical; returns the relationship graphs
(default <code>FALSE</code>). Automatically set to <code>TRUE</code> if <code>return.logp = TRUE</code>.</p></dd>


<dt id="arg-return-logp">return.logp<a class="anchor" aria-label="anchor" href="#arg-return-logp"></a></dt>
<dd><p>Logical; returns the log-likelihood for each relationship
graph (default <code>FALSE</code>). Setting <code>TRUE</code> disables permutation symmetry
optimisation and thus increases runtime, especially when MOIs are large.
Does not affect the output of the posterior probabilities; see
<code><a href="../articles/demonstrate-usage.html">vignette("demonstrate-usage")</a></code> — clickable online
<a href="../doc/demonstrate-usage.html">(offline link)</a> —
which also contains an example of permutation symmetry.</p></dd>


<dt id="arg-progress-bar">progress.bar<a class="anchor" aria-label="anchor" href="#arg-progress-bar"></a></dt>
<dd><p>Logical; show progress bars (default <code>TRUE</code>).
Note that the progress bar may update non-uniformly.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>List containing:</p><dl><dt><code>marg</code></dt>
<dd><p>Matrix of marginal posterior probabilities for each recurrence,
with rows as recurrences and columns as "C" (recrudescence), "L"
(relapse), and "I" (reinfection). Each marginal probability sums over a
subset of joint probabilities. For example, the marginal probability of
"C" at the first of two recurrences sums over the joint probabilities
of "CC", "CL", and "CI".</p></dd>

<dt><code>joint</code></dt>
<dd><p>Vector of joint posterior probabilities for each recurrence
state sequence; within a sequence "C", "L", and "I" are used as above.</p></dd>

<dt><code>RGs</code></dt>
<dd><p>List of lists encoding relationship graphs; returned only if
<code>return.RG = TRUE</code> (default <code>FALSE</code>), and with log-likelihoods if
<code>return.logp = TRUE</code> (default <code>FALSE</code>). A relationship graph
encoded as a list can be converted into a <code>igraph</code> object using
<code><a href="RG_to_igraph.html">RG_to_igraph</a></code> and thus plotted using
<code><a href="plot_RG.html">plot_RG</a></code>. For more details on relationship graphs, see
<code><a href="enumerate_RGs.html">enumerate_RGs</a></code>.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>compute_posterior()</code> computes posterior probabilities proportional to
the likelihood multiplied by the prior. The likelihood sums over:</p><ul><li><p>ways to phase allelic data onto haploid genotypes</p></li>
<li><p>graphs of relationships between haploid genotypes</p></li>
<li><p>ways to partition alleles into clusters of identity-by-descent</p></li>
</ul><p>We enumerate all possible relationship graphs between haploid genotypes,
where pairs of genotypes can either be clones, siblings, or strangers. The
likelihood of a sequence of recurrence states can be determined from the
likelihood of all relationship graphs compatible with said sequence. More
details on the enumeration of relationship graphs can be found in
<code><a href="enumerate_RGs.html">enumerate_RGs</a></code>. For each relationship graph, the model sums over
all possible identity-by-descent partitions. Because some graphs are
compatible with more partitions than others, the log p(Y|RG) progress bar may
advance non-uniformly. We do not recommend running `compute_posterior() when
the total genotype count (sum of MOIs) exceeds eight because there are too
many relationship graphs.</p>
<p>Notable model assumptions and limitations:</p><ul><li><p>All siblings are regular siblings</p></li>
<li><p>Recrudescent parasites derive only from the immediately preceding
episode</p></li>
<li><p>Recrudescence, relapse and reinfection are mutually exclusive</p></li>
<li><p>Undetected alleles, genotyping errors, and <em>de novo</em> mutations
are not modelled</p></li>
<li><p>Population structure and various other complexities that confound
molecular correction are not modelled</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Numerically named alleles</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>enrol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>m1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'3'</span>,<span class="st">'2'</span><span class="op">)</span>, m2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'1'</span>,<span class="st">'2'</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>          recur1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>m1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'1'</span>,<span class="st">'4'</span><span class="op">)</span>, m2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'1'</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>          recur2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>m1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'1'</span><span class="op">)</span>, m2 <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>m1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'1'</span> <span class="op">=</span> <span class="fl">0.78</span>, <span class="st">'2'</span> <span class="op">=</span> <span class="fl">0.14</span>, <span class="st">'3'</span> <span class="op">=</span> <span class="fl">0.07</span>, <span class="st">'4'</span> <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           m2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'1'</span> <span class="op">=</span> <span class="fl">0.27</span>, <span class="st">'2'</span> <span class="op">=</span> <span class="fl">0.73</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">compute_posterior</span><span class="op">(</span><span class="va">y</span>, <span class="va">fs</span>, progress.bar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number of valid relationship graphs (RGs) is 250</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing log p(Y|RG) for 250 RGs</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Finding log-likelihood of each vector of recurrence states</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $marg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                C         L         I</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> recur1 0.0000000 0.1949556 0.8050444</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> recur2 0.2938829 0.2476598 0.4584573</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $joint</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         CC         LC         IC         CL         LL         IL         CI </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.00000000 0.05539481 0.23848807 0.00000000 0.05314490 0.19451493 0.00000000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         LI         II </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.08641590 0.37204139 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Arbitrarily named alleles, plotting per-recurrence posteriors</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>enrolment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>marker1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tinky Winky"</span>, <span class="st">"Dipsy"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                          marker2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tinky Winky"</span>, <span class="st">"Laa-Laa"</span>, <span class="st">"Po"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>          recurrence <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>marker1 <span class="op">=</span> <span class="st">"Tinky Winky"</span>,</span></span>
<span class="r-in"><span>                          marker2 <span class="op">=</span> <span class="st">"Laa-Laa"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>marker1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tinky Winky"</span> <span class="op">=</span> <span class="fl">0.4</span>, <span class="st">"Dipsy"</span> <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           marker2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tinky Winky"</span> <span class="op">=</span> <span class="fl">0.1</span>, <span class="st">"Laa-Laa"</span> <span class="op">=</span> <span class="fl">0.1</span>, <span class="st">"Po"</span> <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_simplex.html">plot_simplex</a></span><span class="op">(</span>p.coords <span class="op">=</span> <span class="fu">compute_posterior</span><span class="op">(</span><span class="va">y</span>, <span class="va">fs</span>, progress.bar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">marg</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number of valid relationship graphs (RGs) is 30</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing log p(Y|RG) for 30 RGs</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Finding log-likelihood of each vector of recurrence states</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-plt img"><img src="compute_posterior-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Episode names are cosmetic: "r1_prior" is returned for "r2"</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>enrol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>m1 <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>, r2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>m1 <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>, r1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>m1 <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.6</span>,<span class="fl">0.7</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>,<span class="fl">0.2</span>,<span class="fl">0</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>                dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"r1_prior"</span>, <span class="st">"r2_prior"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C"</span>, <span class="st">"L"</span>, <span class="st">"I"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span><span class="fu">compute_posterior</span><span class="op">(</span><span class="va">y</span>, fs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>m1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="va">prior</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">marg</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Data and prior episode names disagree</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Marker m1 has data on fewer than two episodes</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Episodes enrol &amp; r2 &amp; r1 have no data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      C   L   I</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> r2 0.6 0.2 0.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> r1 0.7 0.3 0.0</span>
<span class="r-in"><span><span class="va">prior</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            C   L   I</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> r1_prior 0.6 0.2 0.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> r2_prior 0.7 0.3 0.0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Prior is returned when all data are missing</span></span></span>
<span class="r-in"><span><span class="va">y_missing</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>enrol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>m1 <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>, recur <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>m1 <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span><span class="fu">compute_posterior</span><span class="op">(</span><span class="va">y_missing</span>, fs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>m1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Marker m1 has data on fewer than two episodes</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Episodes enrol &amp; recur have no data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $marg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               C         L         I</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> recur 0.3333333 0.3333333 0.3333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $joint</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         C         L         I </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.3333333 0.3333333 0.3333333 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Return of the prior re-weighted to the exclusion of recrudescence:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span><span class="fu">compute_posterior</span><span class="op">(</span><span class="va">y_missing</span>, fs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>m1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 MOIs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Marker m1 has data on fewer than two episodes</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Episodes enrol &amp; recur have no data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $marg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       C   L   I</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> recur 0 0.5 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $joint</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   C   L   I </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.0 0.5 0.5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># (Recrudescing parasites are clones of previous blood-stage parasites. The</span></span></span>
<span class="r-in"><span><span class="co"># Pv3R model assumes no within-host de-novo mutations and perfect allele</span></span></span>
<span class="r-in"><span><span class="co"># detection. As such, recrudescence is incompatible with an MOI increase on</span></span></span>
<span class="r-in"><span><span class="co"># the preceding infection.)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Beware provision of unpaired data: the prior is not necessarily returned;</span></span></span>
<span class="r-in"><span><span class="co"># for more details, see link above to "Understand posterior estimates"</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>m1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'1'</span>, <span class="st">'2'</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>m1 <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>m1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'1'</span> <span class="op">=</span> <span class="fl">0.5</span>, <span class="st">'2'</span> <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span><span class="fu">compute_posterior</span><span class="op">(</span><span class="va">y</span>, <span class="va">fs</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">marg</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Marker m1 has data on fewer than two episodes</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              C         L         I</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.3292683 0.3414634 0.3292683</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Aimee Taylor, Yong See Foo, European Union, Project 101110393.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

