<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plots the data — plot_data • Pv3Rs</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plots the data — plot_data"><meta name="description" content="Plots allelic data as a grid of coloured rectangles."><meta property="og:description" content="Plots allelic data as a grid of coloured rectangles."><meta property="og:image" content="https://aimeertaylor.github.io/Pv3Rs/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Pv3Rs</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/demonstrate-usage.html">Demonstrate Pv3Rs usage</a></li>
    <li><a class="dropdown-item" href="../articles/intra-episode-siblings.html">Explore treatment of intra-episode siblings</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/aimeertaylor/Pv3Rs/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Plots the data</h1>
      <small class="dont-index">Source: <a href="https://github.com/aimeertaylor/Pv3Rs/blob/main/R/plot_data.R" class="external-link"><code>R/plot_data.R</code></a></small>
      <div class="d-none name"><code>plot_data.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Plots allelic data as a grid of coloured rectangles.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_data</span><span class="op">(</span></span>
<span>  <span class="va">ys</span>,</span>
<span>  fs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  person.vert <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">3.5</span>, <span class="fl">1.5</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  gridlines <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  palette <span class="op">=</span> <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">12</span>, <span class="st">"Paired"</span><span class="op">)</span>,</span>
<span>  marker.annotate <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  legend.lab <span class="op">=</span> <span class="st">"Allele frequencies"</span>,</span>
<span>  legend.line <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  legend.ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.2</span><span class="op">)</span>,</span>
<span>  cex.maj <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  cex.min <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  cex.text <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  x.line <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  y.line <span class="op">=</span> <span class="fl">2.5</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-ys">ys<a class="anchor" aria-label="anchor" href="#arg-ys"></a></dt>
<dd><p>Nested list of per-person, per-episode, per-marker allelic data;
see <strong>Examples</strong> and <code><a href="compute_posterior.html">compute_posterior()</a></code> for the expected per-person structure.</p></dd>


<dt id="arg-fs">fs<a class="anchor" aria-label="anchor" href="#arg-fs"></a></dt>
<dd><p>A per-marker list of numeric vectors of allele frequencies. If
<code>NULL</code> (default), only the alleles present in <code>ys</code> are shown in the the
legend, with all per-marker alleles represented equally. Because the colour
scheme is adaptive, the same allele may have different colours given
different <code>ys</code>. If <code>fs</code> is specified, all alleles in <code>fs</code> feature in the
legend with areas proportional to allele frequencies, so that common alleles
occupy larger areas than rarer alleles. Specify <code>fs</code> to fix the allele
colour scheme across plots of different <code>ys</code>.</p></dd>


<dt id="arg-person-vert">person.vert<a class="anchor" aria-label="anchor" href="#arg-person-vert"></a></dt>
<dd><p>Logical. If <code>TRUE</code> (default), person IDs are printed
vertically; otherwise, they are printed horizontally.</p></dd>


<dt id="arg-mar">mar<a class="anchor" aria-label="anchor" href="#arg-mar"></a></dt>
<dd><p>Vector of numbers of lines of margin for the main
plot; see <code>mar</code> entry of <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code>.</p></dd>


<dt id="arg-gridlines">gridlines<a class="anchor" aria-label="anchor" href="#arg-gridlines"></a></dt>
<dd><p>Logical. If true (default), white grid lines separating
people and markers are drawn.</p></dd>


<dt id="arg-palette">palette<a class="anchor" aria-label="anchor" href="#arg-palette"></a></dt>
<dd><p>Colour palette for alleles, see the <strong>Value</strong> section of
<code><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></code>. Generally, colours are interpolated:
if a marker has <code>d</code> possible alleles, then the colours used are the
<code>1/(d+1), ..., d/(d+1)</code> quantiles of the palette to ensure that markers
with different allele counts use different colours.</p></dd>


<dt id="arg-marker-annotate">marker.annotate<a class="anchor" aria-label="anchor" href="#arg-marker-annotate"></a></dt>
<dd><p>Logical. If true (default), the names of the alleles
are printed on top of their colours in the legend.</p></dd>


<dt id="arg-legend-lab">legend.lab<a class="anchor" aria-label="anchor" href="#arg-legend-lab"></a></dt>
<dd><p>Label for the axis of the legend. Defaults to "Allele
frequencies". Set to <code>NA</code> to omit the label; if so, consider
adjusting <code>legend.ylim</code> to use more plotting space.</p></dd>


<dt id="arg-legend-line">legend.line<a class="anchor" aria-label="anchor" href="#arg-legend-line"></a></dt>
<dd><p>Distance (in character heights) from the colour bar
to the legend label (defaults to <code>1.5</code>).</p></dd>


<dt id="arg-legend-ylim">legend.ylim<a class="anchor" aria-label="anchor" href="#arg-legend-ylim"></a></dt>
<dd><p>Vector specifying the y-coordinate limits
of the legend in device coordinates (between 0 and 1). Defaults to c(0.05, 0.2).</p></dd>


<dt id="arg-cex-maj">cex.maj<a class="anchor" aria-label="anchor" href="#arg-cex-maj"></a></dt>
<dd><p>Numeric; font scaling of major axis labels.</p></dd>


<dt id="arg-cex-min">cex.min<a class="anchor" aria-label="anchor" href="#arg-cex-min"></a></dt>
<dd><p>Numeric; font scaling of minor axis labels.</p></dd>


<dt id="arg-cex-text">cex.text<a class="anchor" aria-label="anchor" href="#arg-cex-text"></a></dt>
<dd><p>Numeric; font scaling of the allele labels.</p></dd>


<dt id="arg-x-line">x.line<a class="anchor" aria-label="anchor" href="#arg-x-line"></a></dt>
<dd><p>Distance between top x-axis and x-axis label, defaults to 0.2.</p></dd>


<dt id="arg-y-line">y.line<a class="anchor" aria-label="anchor" href="#arg-y-line"></a></dt>
<dd><p>Distance between left y-axis and y-axis label, defaults to 2.5.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>None</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function plots alleles (colours), which are observed in different
episodes (columns), on different markers (rows), with episodes grouped by
person. Per-person episodes are plotted from left to right in chronological
order. If multiple alleles are detected for a marker within an episode, the
corresponding grid element is subdivided vertically into different colours.</p>
<p>By default, markers are ordered lexicographically. If <code>fs</code> is provided,
markers are ordered to match the order within <code>fs</code>.</p>
<p>The legend depicts the alleles for each marker in the same vertical order as
the main plot. The default colour scheme is adaptive, designed to
visually differentiate the alleles as clearly as possible by maximizing hue contrast within a qualitative palette.
Interpolation is used to make different colour palettes for markers with
different numbers of possible alleles. The names of the alleles are printed
on top of their colours if <code>marker.annotate</code> is set to <code>TRUE</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot example Plasmodium vivax data set</span></span></span>
<span class="r-in"><span><span class="va">mar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3.5</span>, <span class="fl">1.5</span>, <span class="fl">1</span><span class="op">)</span> <span class="co"># extra vertical margin for vertical person labels</span></span></span>
<span class="r-in"><span><span class="fu">plot_data</span><span class="op">(</span>ys <span class="op">=</span> <span class="va">ys_VHX_BPD</span>, person.vert <span class="op">=</span> <span class="cn">TRUE</span>, mar <span class="op">=</span> <span class="va">mar</span>, legend.lab <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_data-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">plot_data</span><span class="op">(</span>ys <span class="op">=</span> <span class="va">ys_VHX_BPD</span>, person.vert <span class="op">=</span> <span class="cn">TRUE</span>, mar <span class="op">=</span> <span class="va">mar</span>, legend.lab <span class="op">=</span> <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>          fs <span class="op">=</span> <span class="va">fs_VHX_BPD</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_data-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">plot_data</span><span class="op">(</span>ys <span class="op">=</span> <span class="va">ys_VHX_BPD</span>, person.vert <span class="op">=</span> <span class="cn">TRUE</span>, mar <span class="op">=</span> <span class="va">mar</span>, legend.lab <span class="op">=</span> <span class="cn">NA</span>,</span></span>
<span class="r-in"><span>          fs <span class="op">=</span> <span class="va">fs_VHX_BPD</span>, marker.annotate <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_data-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Demonstrating the adaptive nature of the colour scheme:</span></span></span>
<span class="r-in"><span><span class="va">ys</span> <span class="op">&lt;-</span> <span class="va">ys_VHX_BPD</span><span class="op">[</span><span class="st">"VHX_52"</span><span class="op">]</span> <span class="co"># A single person</span></span></span>
<span class="r-in"><span><span class="fu">plot_data</span><span class="op">(</span><span class="va">ys</span>, fs <span class="op">=</span> <span class="va">fs_VHX_BPD</span>, marker.annotate <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># Colours match above</span></span></span>
<span class="r-plt img"><img src="plot_data-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">plot_data</span><span class="op">(</span><span class="va">ys</span><span class="op">)</span> <span class="co"># Colours and the legend adapt to alleles detected in VHX_52</span></span></span>
<span class="r-plt img"><img src="plot_data-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Aimee Taylor, Yong See Foo, European Union, Project 101110393.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

